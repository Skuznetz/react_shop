import {
    FETCH_BOOKS_START,
    FETCH_BOOKS_SUCCESS,
    FETCH_BOOKS_FAILURE,
    LOAD_MORE_BOOKS_START,
    LOAD_MORE_BOOKS_SUCCESS,
    LOAD_MORE_BOOKS_FAILURE
} from 'actionTypes'
import {getRenderedBooksLength} from 'selectors'

import { fetchBooks as fetchBooksApi,loadMoreBooks as loadMoreBooksApi} from 'api'

export const fetchBooks = () => async dispatch =>{
    dispatch({type: FETCH_BOOKS_START})
try {
    const books = await fetchBooksApi()
    dispatch({type: FETCH_BOOKS_SUCCESS,payload: books})
}
catch (err) {
    dispatch({type: FETCH_BOOKS_FAILURE,
    payload: err,
error: true})
}
}

export const loadMoreBooks = () => async (dispatch,getState) =>{
    const offset = getRenderedPhonesLength(getState())
    dispatch({type: LOAD_MORE_BOOKS_START})
try {
    const books = await loadMoreBooksApi(offset)
    dispatch({type: LOAD_MORE_BOOKS_SUCCESS,payload: books})
}
catch (err) {
    dispatch({type: LOAD_MORE_BOOKS_FAILURE,
    payload: err,
error: true})
}
}