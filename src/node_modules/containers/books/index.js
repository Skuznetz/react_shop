import React,{Component} from 'react'
import {connect} from 'react-redux'
import {fetchBooks} from 'actions'
import {getBooks} from 'selectors'
import * as R from 'ramda'
import {Link} from 'react-router-dom'

class Books extends Component {
    componentDidMount(){
        this.props.fetchBooks()
    }
    renderBook(book,index){
        const shortDescription = `${R.take(60,book.description)}...`

        return (
            <div className ='col-sm-4 col-lg-4 col-md-4 book-list' key={index}>
                <div className='thumbnail'>
                    <img className='img-thumbnail'
                         src = {book.image}
                         alt = {book.name}
                          />
                        <div className='caption'>
                            <h4>
                                <Link to={`/books/${book.id}`}>
                                {book.name}</Link>
                            </h4>
                            <p>{shortDescription}</p>
                            <p className='itemButton'>
                            <button className='btn-btn-primary'>Buy now</button>
                            <Link to={`/books/${book.id}`} className='btn btn-default'>More info</Link>
                            </p>
                        </div>
                </div>
            </div>
        )
    }
    render(){
         const {books} =this.props
        return (
            <div>
                 <div className='books row'>
                    {books.map((book,index) =>this.renderBook(book,index))}
                </div>
            </div>
        )
    }
}
const mapStateToProps = state =>({
    books: getBooks(state)
    
})


const mapDispatchToProps={
    fetchBooks
}
    
export default connect(mapStateToProps,mapDispatchToProps)(Books)